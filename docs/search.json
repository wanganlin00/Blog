[
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post.Welcome!"
  },
  {
    "objectID": "posts/TCGA/TCGA.html",
    "href": "posts/TCGA/TCGA.html",
    "title": "TCGA",
    "section": "",
    "text": "https://portal.gdc.cancer.gov/\nhttps://www.jingege.wang/2024/02/25/tcga-gdc-data-portal-2-0/\nhttps://www.jingege.wang/2022/07/16/tcgar/\n\nShow the codelibrary(jsonlite)\n\njson &lt;- jsonlite::fromJSON(\"data/metadata.cart.2024-07-04.json\") |&gt; as_tibble()\n\njson |&gt; select(associated_entities)\n\n# A tibble: 536 × 1\n   associated_entities\n   &lt;list&gt;             \n 1 &lt;df [1 × 4]&gt;       \n 2 &lt;df [1 × 4]&gt;       \n 3 &lt;df [1 × 4]&gt;       \n 4 &lt;df [1 × 4]&gt;       \n 5 &lt;df [1 × 4]&gt;       \n 6 &lt;df [1 × 4]&gt;       \n 7 &lt;df [1 × 4]&gt;       \n 8 &lt;df [1 × 4]&gt;       \n 9 &lt;df [1 × 4]&gt;       \n10 &lt;df [1 × 4]&gt;       \n# ℹ 526 more rows\n\nShow the codejson$associated_entities[[1]]\n\n           entity_submitter_id entity_type                              case_id\n1 TCGA-38-7271-01A-11R-2039-07     aliquot 8214a0d1-5e2d-4a7a-acb1-e5580755db83\n                             entity_id\n1 8d895d3d-9598-459b-813e-3fc84dd3efe8\n\nShow the code# sample_id &lt;- map_vec(json$associated_entities,~ .x[,1])\nsample_id &lt;- sapply(json$associated_entities,function(x){x[,1]})\n\n\nfile_sample &lt;- tibble(sample_id,file_name=json$file_name) \n\n\n\nShow the code#获取gdc_download文件夹下的所有TSV表达文件的 路径+文件名\ncount_file &lt;- list.files(\"data/gdc_download_20240704_131631.625023\",pattern = \"*.tsv\",recursive = TRUE)\n#在count_file中分割出文件名\ncount_file_name &lt;- str_split(count_file,pattern = '/') \n\ncount_file_name &lt;- sapply(count_file_name,function(x){x[2]})\n\n\n\n\nShow the codematrix = data.frame(matrix(nrow=60660,ncol=0))\n\n\nfor (i in 1:length(count_file)) {\n    path = paste0('data/gdc_download_20240704_131631.625023/',\n                  count_file[i])\n    data &lt;- read_tsv(path, col_names = T, skip = 1)\n    data &lt;- data[-c(1:4), c(1, 4)] |&gt; column_to_rownames(var = \"gene_id\")  #取出ESEMBL_id列1 和 unstranded列 4，即count数据，对应其它数据，第2列为gene symbol\n    colnames(data) &lt;- file_sample$sample_id[which(file_sample$file_name == count_file_name[i])]\n    \n    matrix &lt;- cbind(matrix, data)\n}\nwrite.csv(matrix,'data/COUNT_matrix.csv',row.names = TRUE)\n\n\n\n根据TCGA样本的命名可以区分正常组织和肿瘤样本的测序结果 其中 14、15位置编号大于10 表示正常\n\nShow the codeCOUNT_matrix &lt;- read_csv('data/COUNT_matrix.csv') |&gt; column_to_rownames(var = \"...1\")\n\n\nstr_sub(colnames(COUNT_matrix),14,15) |&gt; table()\n\n\n 01  02  11 \n481   2  53 \n\n\n\n\nShow the codejson &lt;- jsonlite::fromJSON(\"data/metadata.cart.2024-07-04.json\")\n\nentity_submitter_id &lt;- sapply(json$associated_entities,function(x){x[,1]})\ncase_id &lt;- sapply(json$associated_entities,function(x){x[,3]})\nsample_case &lt;- t(rbind(entity_submitter_id,case_id)) |&gt; as_tibble()\n\nclinical &lt;- read.delim('data/clinical.cart.2024-07-04/clinical.tsv',header = T)\n\nclinical &lt;- clinical |&gt; distinct(case_id,.keep_all = TRUE)\n\n\n\n\n\nclinical_matrix &lt;- left_join(sample_case,clinical,by = join_by(case_id))\n\nclinical_matrix &lt;- clinical_matrix |&gt; select(-case_id)\n\n\n\n\nShow the codejson &lt;- jsonlite::fromJSON(\"metadata.cart.2022-09-27.json\")\n\n#id &lt;- json$associated_entities[[1]][,1]\nsample_id &lt;- sapply(json$associated_entities,function(x){x[,1]})\nfile_sample &lt;- data.frame(sample_id,file_name=json$file_name)  \n\n#获取gdc_download文件夹下的所有miRNA表达文件的 路径+文件名\ncount_file &lt;- list.files('gdc_download_20220927_150057.906231',pattern = '*quantification.txt',recursive = TRUE)\n#在count_file中分割出文件名\ncount_file_name &lt;- strsplit(count_file,split='/')\ncount_file_name &lt;- sapply(count_file_name,function(x){x[2]})\n\nmatrix = data.frame(matrix(nrow=1881,ncol=0))\nfor (i in 1:length(count_file)){\n  path = paste0('gdc_download_20220927_150057.906231//',count_file[i])\n  data&lt;- read.delim(path,fill = TRUE,header = T,row.names = 1)\n  data &lt;- data[1]   #取出count列（第1列），rpm列（第2列）\n  colnames(data) &lt;- file_sample$sample_id[which(file_sample$file_name==count_file_name[i])]\n  matrix &lt;- cbind(matrix,data)\n}\n\n\n\nhttps://bioconductor.org/packages/release/workflows/html/TCGAWorkflow.html"
  },
  {
    "objectID": "posts/TCGA/TCGA.html#计数矩阵",
    "href": "posts/TCGA/TCGA.html#计数矩阵",
    "title": "TCGA",
    "section": "",
    "text": "Show the codematrix = data.frame(matrix(nrow=60660,ncol=0))\n\n\nfor (i in 1:length(count_file)) {\n    path = paste0('data/gdc_download_20240704_131631.625023/',\n                  count_file[i])\n    data &lt;- read_tsv(path, col_names = T, skip = 1)\n    data &lt;- data[-c(1:4), c(1, 4)] |&gt; column_to_rownames(var = \"gene_id\")  #取出ESEMBL_id列1 和 unstranded列 4，即count数据，对应其它数据，第2列为gene symbol\n    colnames(data) &lt;- file_sample$sample_id[which(file_sample$file_name == count_file_name[i])]\n    \n    matrix &lt;- cbind(matrix, data)\n}\nwrite.csv(matrix,'data/COUNT_matrix.csv',row.names = TRUE)"
  },
  {
    "objectID": "posts/TCGA/TCGA.html#normal-和-tumor",
    "href": "posts/TCGA/TCGA.html#normal-和-tumor",
    "title": "TCGA",
    "section": "",
    "text": "根据TCGA样本的命名可以区分正常组织和肿瘤样本的测序结果 其中 14、15位置编号大于10 表示正常\n\nShow the codeCOUNT_matrix &lt;- read_csv('data/COUNT_matrix.csv') |&gt; column_to_rownames(var = \"...1\")\n\n\nstr_sub(colnames(COUNT_matrix),14,15) |&gt; table()\n\n\n 01  02  11 \n481   2  53"
  },
  {
    "objectID": "posts/TCGA/TCGA.html#表型矩阵",
    "href": "posts/TCGA/TCGA.html#表型矩阵",
    "title": "TCGA",
    "section": "",
    "text": "Show the codejson &lt;- jsonlite::fromJSON(\"data/metadata.cart.2024-07-04.json\")\n\nentity_submitter_id &lt;- sapply(json$associated_entities,function(x){x[,1]})\ncase_id &lt;- sapply(json$associated_entities,function(x){x[,3]})\nsample_case &lt;- t(rbind(entity_submitter_id,case_id)) |&gt; as_tibble()\n\nclinical &lt;- read.delim('data/clinical.cart.2024-07-04/clinical.tsv',header = T)\n\nclinical &lt;- clinical |&gt; distinct(case_id,.keep_all = TRUE)\n\n\n\n\n\nclinical_matrix &lt;- left_join(sample_case,clinical,by = join_by(case_id))\n\nclinical_matrix &lt;- clinical_matrix |&gt; select(-case_id)"
  },
  {
    "objectID": "posts/TCGA/TCGA.html#mirna-计数矩阵",
    "href": "posts/TCGA/TCGA.html#mirna-计数矩阵",
    "title": "TCGA",
    "section": "",
    "text": "Show the codejson &lt;- jsonlite::fromJSON(\"metadata.cart.2022-09-27.json\")\n\n#id &lt;- json$associated_entities[[1]][,1]\nsample_id &lt;- sapply(json$associated_entities,function(x){x[,1]})\nfile_sample &lt;- data.frame(sample_id,file_name=json$file_name)  \n\n#获取gdc_download文件夹下的所有miRNA表达文件的 路径+文件名\ncount_file &lt;- list.files('gdc_download_20220927_150057.906231',pattern = '*quantification.txt',recursive = TRUE)\n#在count_file中分割出文件名\ncount_file_name &lt;- strsplit(count_file,split='/')\ncount_file_name &lt;- sapply(count_file_name,function(x){x[2]})\n\nmatrix = data.frame(matrix(nrow=1881,ncol=0))\nfor (i in 1:length(count_file)){\n  path = paste0('gdc_download_20220927_150057.906231//',count_file[i])\n  data&lt;- read.delim(path,fill = TRUE,header = T,row.names = 1)\n  data &lt;- data[1]   #取出count列（第1列），rpm列（第2列）\n  colnames(data) &lt;- file_sample$sample_id[which(file_sample$file_name==count_file_name[i])]\n  matrix &lt;- cbind(matrix,data)\n}"
  },
  {
    "objectID": "posts/TCGA/TCGA.html#tcgaworkflow",
    "href": "posts/TCGA/TCGA.html#tcgaworkflow",
    "title": "TCGA",
    "section": "",
    "text": "https://bioconductor.org/packages/release/workflows/html/TCGAWorkflow.html"
  },
  {
    "objectID": "posts/iterated function system/iterated function system.html",
    "href": "posts/iterated function system/iterated function system.html",
    "title": "iterated function system",
    "section": "",
    "text": "Art code\n\nShow the codelibrary(Rcpp)\nlibrary(ggplot2)\nlibrary(tibble)\nlibrary(purrr)\nlibrary(dplyr)\nlibrary(ggthemes)\nlibrary(tictoc)\n\n\n\nShow the codefern_transform &lt;- function(coord, ind) {\n  \n  # coefficients for the stem function f_1\n  if(ind == 1) {\n    mat &lt;- matrix(c(0, 0, 0, .16), 2, 2) # matrix to multiply\n    off &lt;- c(0, 0)                       # offset vector to add\n  }\n  \n  # coefficients for the small leaflet function f_2\n  if(ind == 2) {\n    mat &lt;- matrix(c(.85, -.04, .04, .85), 2, 2)\n    off &lt;- c(0, 1.6)                      \n  }\n  # coefficients for the right-side function f_3\n  if(ind == 3) {\n    mat &lt;- matrix(c(.2, .23, -.26, .22), 2, 2)\n    off &lt;- c(0, 1.6)                      \n  }\n  \n  # coefficients for the left-side function f_4\n  if(ind == 4) {\n    mat &lt;- matrix(c(-.15, .26, .28, .24), 2, 2)\n    off &lt;- c(0, .44)                     \n  }\n  \n  # return the affine transformed coords\n  coord &lt;- mat %*% coord + off\n  return(coord)\n}\n\n\n\nShow the codefern_chaos &lt;- function(iterations = 10000, seed = NULL) {\n  if(!is.null(seed)) set.seed(seed)\n  \n  # which transformation to apply at each iteration\n  transform_index &lt;- sample(\n    x = 1:4, \n    size = iterations, \n    replace= TRUE, \n    prob = c(.01, .85, .07, .07)\n  )\n  \n  # initialise chaos game at the origin\n  start &lt;- matrix(c(0, 0))\n  \n  # helper function to collapse accumulated output\n  bind_to_column_matrix &lt;- function(lst) {\n    do.call(cbind, lst)\n  }\n  \n  # iterate until done!\n  coord_matrix &lt;- transform_index |&gt;\n    accumulate(fern_transform, .init = start) |&gt;\n    bind_to_column_matrix() \n  \n  # tidy the output, add extra columns, and return\n  coord_df &lt;- t(coord_matrix) |&gt; \n    as.data.frame() \n  names(coord_df) &lt;- c(\"x\", \"y\")\n  coord_df &lt;- coord_df |&gt;\n    as_tibble() |&gt;\n    mutate(\n      transform = c(0, transform_index),\n      iteration = row_number() - 1\n    )\n  return(coord_df)\n}\n\n\n\nShow the codefern_dat &lt;- fern_chaos(seed = 1)\nfern_dat %&gt;% head()\n\n# A tibble: 6 × 4\n       x     y transform iteration\n   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1  0      0            0         0\n2  0      1.6          2         1\n3  0.064  2.96         2         2\n4  0.173  4.11         2         3\n5 -1.03   2.54         3         4\n6 -0.778  3.80         2         5\n\n\n\nShow the codeggplot(fern_dat, aes(x, y)) +\n  geom_point(colour = \"yellow\", size = 1, stroke = 0) +\n  coord_equal() +\n  theme_void()\n\n\n\n\n\n\n\n\nShow the codeggplot(fern_dat, aes(x, y, colour = iteration)) +\n  geom_point(size = 1, stroke = 0, show.legend = FALSE) +\n  coord_equal() +\n  theme_void()"
  },
  {
    "objectID": "posts/ggpattern/ggpattern.html",
    "href": "posts/ggpattern/ggpattern.html",
    "title": "ggpattern: ggplot2 with geometric texture amd images",
    "section": "",
    "text": "ggpattern 填充几何纹理或图像"
  },
  {
    "objectID": "posts/ggpattern/ggpattern.html#先决条件",
    "href": "posts/ggpattern/ggpattern.html#先决条件",
    "title": "ggpattern: ggplot2 with geometric texture amd images",
    "section": "先决条件",
    "text": "先决条件\n\nShow the codelibrary(ggplot2)\nlibrary(patchwork)\nlibrary(ggpattern)\nlibrary(gridpattern)\n\n\n\nShow the codeset.seed(123)\ndf &lt;- tibble(\n    group = letters[1:5],\n    value = round(runif(5,min = 10,max = 100),digits = 0)\n)\n\ndf %&gt;% \n    ggplot(mapping = aes(x = group, y = value, fill = group)) +\n    geom_col()"
  },
  {
    "objectID": "posts/ggpattern/ggpattern.html#ggpattern",
    "href": "posts/ggpattern/ggpattern.html#ggpattern",
    "title": "ggpattern: ggplot2 with geometric texture amd images",
    "section": "ggpattern",
    "text": "ggpattern\n几何纹理\n\nShow the codenames_magick_stripe\n\n [1] \"crosshatch\"    \"crosshatch30\"  \"crosshatch45\"  \"horizontal\"   \n [5] \"horizontal2\"   \"horizontal3\"   \"hs_bdiagonal\"  \"hs_cross\"     \n [9] \"hs_diagcross\"  \"hs_fdiagonal\"  \"hs_horizontal\" \"hs_vertical\"  \n[13] \"left30\"        \"left45\"        \"right30\"       \"right45\"      \n[17] \"vertical\"      \"vertical2\"     \"vertical3\"    \n\nShow the codenames_hex\n\n[1] \"hex\"      \"hex1\"     \"hex2\"     \"hex3\"     \"hex_skew\"\n\nShow the codenames_pattern\n\n [1] \"ambient\"         \"circle\"          \"crosshatch\"      \"fill\"           \n [5] \"gradient\"        \"image\"           \"magick\"          \"none\"           \n [9] \"pch\"             \"placeholder\"     \"plasma\"          \"polygon_tiling\" \n[13] \"regular_polygon\" \"rose\"            \"stripe\"          \"text\"           \n[17] \"wave\"            \"weave\"          \n\n\n 'stripe' (default), 'crosshatch', 'pch', 'circle', 'none'\n\nShow the codep1 &lt;- ggplot(df, aes(group, value )) +\n  geom_col_pattern(pattern = \"stripe\", \n                   fill= \"white\",  # 条形背景色 \n                   color=\"red\",    # 条形边框色\n                   pattern_fill = \"skyblue\", # 几何纹理填充色\n                   pattern_colour=\"darkgreen\",\n                   pattern_angle =30,    # 旋转角度\n                   pattern_linetype= 3 ,# 笔划stroke 线型\n                   pattern_size= 1.2,   #笔画线宽\n                   ) +\n    ggtitle(\"线条：stripe\")\n\np2 &lt;- ggplot(df, aes(group, value )) +\n  geom_col_pattern(pattern = \"crosshatch\", \n                   fill= \"white\",  # 条形背景色 \n                   color=\"red\",    # 条形边框色\n                   pattern_fill = \"red\", # 几何纹理填充色\n                   pattern_colour=\"green\",\n                   pattern_angle =30 ,  # 角度\n                   pattern_spacing= 0.2\n                   ) +\n    ggtitle(\"交叉平行线：crosshatch\")\n\n\np3 &lt;- ggplot(df, aes(group, value )) +\n  geom_col_pattern(pattern = \"pch\",\n                   fill= \"white\",  # 条形背景色 \n                   color=\"red\",    # 条形边框色\n                   pattern_colour=\"green\",\n                   pattern_angle =30,  \n                   pattern_density = 1,\n                   ) +\n    ggtitle(\"点：pch\")\n\np4 &lt;- ggplot(df, aes(group, value )) +\n  geom_col_pattern(pattern = \"circle\",\n                   fill= \"white\",  # 条形背景色 \n                   color=\"red\",    # 条形边框色\n                   pattern_colour=\"darkgreen\",\n                   pattern_fill = \"skyblue\",\n                   pattern_angle =30,   # 角度\n                   pattern_density = 1,\n                   pattern_spacing= 0.2, # 间距\n                   ) +\n    ggtitle(\"圈：circle\")\n\n(p1+p2)/(p3+p4)\n\n\n\n\n\n\n\n波浪图案\n\nShow the codex_hex &lt;- 0.5 + 0.5 * cos(seq(2 * pi / 4, by = 2 * pi / 6, length.out = 6))\ny_hex &lt;- 0.5 + 0.5 * sin(seq(2 * pi / 4, by = 2 * pi / 6, length.out = 6))\ngrid::grid.newpage()\nwave_sine &lt;- grid.pattern_wave(x_hex, y_hex, colour = \"black\", type = \"sine\",\n                  fill = c(\"red\", \"blue\"), density = 0.4,\n                  spacing = 0.15, angle = 0,\n                  amplitude = 0.05, frequency = 1 / 0.20)\n\n\n\n\n\n\nShow the code# zig-zag pattern is a wave of \"type = triangle\"\ngrid::grid.newpage()\nwave_triangle &lt;- grid.pattern_wave(x_hex, y_hex, colour = \"black\", \n                                   type = \"triangle\",\n                    fill = c(\"red\", \"blue\"), density = 0.4,\n                    spacing = 0.15, angle = 0, amplitude = 0.075)\n\n\n\n\n\n\n\n编织类型\npattern_type= ,\npattern_subtype=\n\nShow the codenames_weave\n\n [1] \"basket\"            \"matt\"              \"matt_irregular\"   \n [4] \"plain\"             \"rib_warp\"          \"satin\"            \n [7] \"twill\"             \"twill_elongated\"   \"twill_herringbone\"\n[10] \"twill_zigzag\"     \n\n\n\nShow the codeggplot(df, aes(group, value)) +\n  geom_col_pattern(\n    aes(pattern_fill2=group, pattern_type=group),\n    pattern = 'weave',\n    colour = 'black', \n    pattern_density = 1.0,\n    pattern_fill = 'grey',\n    pattern_key_scale_factor = 0.5,\n  ) +\n  theme_bw() +\n  labs(title = \"Some 'weave' types\") + \n  scale_pattern_type_manual(values=c('plain','matt', 'twill_herringbone',\n                                     \"twill_zigzag\",'satin')) +\n  theme(legend.key.size = unit(1.5, 'cm'))\n\n\n\n\n\n\n\n混合模式\n\nShow the codeggplot(df, aes(group, value)) +\n  geom_col_pattern(aes(fill=group, pattern=group, pattern_type=group),colour='black') + \n  theme_bw() +\n  labs(title = \"Use 'stripe' and 'weave' patterns\") + \n  theme(legend.key.size = unit(1.5, 'cm')) +\n  scale_pattern_manual(values=c('stripe', 'weave', 'weave','stripe', 'weave')) +\n  scale_pattern_type_manual(values=c(NA, 'basket', 'matt', NA, 'twill_elongated'))\n\n\n\n\n\n\n\n\nShow the codelibrary(ggplot2)\nlibrary(ggpattern)\nToothGrowth$dose &lt;- factor(ToothGrowth$dose)\nggplot(ToothGrowth, aes(dose)) +\n  geom_bar_pattern(aes(fill=dose, pattern=dose, pattern_type=dose),colour='black') + \n  theme_bw() +\n  labs(title = \"Use 'stripe' and 'wave' patterns\") + \n  theme(legend.key.size = unit(1.5, 'cm')) +\n  scale_pattern_manual(values=c('stripe', 'wave', 'wave')) +\n  scale_pattern_type_manual(values=c(NA, 'triangle', 'sine'))"
  },
  {
    "objectID": "posts/ggpattern/ggpattern.html#ggpattern-ggh4x",
    "href": "posts/ggpattern/ggpattern.html#ggpattern-ggh4x",
    "title": "ggpattern: ggplot2 with geometric texture amd images",
    "section": "ggpattern + ggh4x",
    "text": "ggpattern + ggh4x\n\nShow the codelibrary(tidyverse)\nlibrary(ggh4x)\nlibrary(ggpattern)\n\nset.seed(233)\ntable1 &lt;- tibble(\n  x=letters[1:4] %&gt;% rep(each=16,length.out=192),\n  y=abs(rnorm(192,50,10)),\n  f=LETTERS[1:4] %&gt;% rep(each=4,length.out=192),\n  g=\"g1\"\n)\ntable2 &lt;- tibble(\n  x=letters[1:4] %&gt;% rep(each=16,length.out=192),\n  y=abs(rnorm(192,50,10)) %&gt;% sort(),\n  f=LETTERS[1:4] %&gt;% rep(each=4,length.out=192),\n  g=\"g2\"\n)\ntable3 &lt;- tibble(\n  x=letters[1:4] %&gt;% rep(each=16,length.out=192),\n  y=abs(rnorm(192,50,10)),\n  f=LETTERS[1:4] %&gt;% rep(each=4,length.out=192),\n  g=\"g3\"\n)\n\ntableAll &lt;- bind_rows(table1,table2,table3)\n\np1 &lt;- tableAll %&gt;% ggplot(aes(interaction(x, g),y,pattern=f)) +\n  stat_summary(geom=GeomColPattern,\n               fun = mean,\n               position = position_dodge(width = 1.2),\n               pattern_spacing = 0.025,\n               fill = 'white', \n               colour = 'black',) + \n  stat_summary(geom=\"errorbar\",\n               fun.data = mean_se,\n               position = position_dodge(width = 1.2)) + \n  scale_x_manual(values = c(1:4+seq(0,1,length.out=4),6:9+1+seq(0,1,length.out=4),11:14+2+seq(0,1,length.out=4)),guide = guide_axis_nested()) +\n  scale_y_continuous(expand = expansion(mult = c(0,0)),\n                     breaks = seq(0,80,by=10),) +\n  labs(x=NULL,y=NULL,pattern=NULL) +\n  guides(pattern=guide_legend(nrow = 1)) +\n  coord_cartesian(ylim = c(0,70)) +\n  theme_classic() + \n  theme(legend.position = \"inside\",\n        legend.position.inside = c(.83,.95),\n        axis.ticks.length.x = unit(0,\"mm\"),\n        axis.ticks.length.y = unit(-1,\"mm\"),\n        ggh4x.axis.nestline = element_line(color=NA))\np1"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "博客"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "HomePage",
    "section": "",
    "text": "ggprism: GraphPad Prism 风格\n\n\n\n\n\n\ngraphics\n\n\nthemes\n\n\nggplot2 extension\n\n\n\n\n\n\n\n\n\nSep 24, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nggpattern: ggplot2 with geometric texture amd images\n\n\n\n\n\n\ngraphics\n\n\nggplot2 extension\n\n\n\n\n\n\n\n\n\nSep 24, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nggforce: 圆角柱状图\n\n\n\n\n\n\ngraphics\n\n\nggplot2 extension\n\n\n\n\n\n\n\n\n\nSep 24, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nUCSC\n\n\n\n\n\n\nbioinformatics\n\n\ndatabase\n\n\n\n\n\n\n\n\n\nSep 24, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nTCGA\n\n\n\n\n\n\nbioinformatics\n\n\ndatabase\n\n\n\n\n\n\n\n\n\nSep 24, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nRT-qPCR\n\n\n\n\n\n\nbioinformatics\n\n\nprotocols\n\n\n\n\n\n\n\n\n\nSep 24, 2024\n\n\n\n\n\n\n\n\n\n\n\n\niterated function system\n\n\n\n\n\n\ngraphics\n\n\nart\n\n\n\n\n\n\n\n\n\nSep 23, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nWelcome To My Blog\n\n\n\n\n\n\nwelcome\n\n\n\n\n\n\n\n\n\nSep 23, 2024\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/ggprism/ggprism.html",
    "href": "posts/ggprism/ggprism.html",
    "title": "ggprism: GraphPad Prism 风格",
    "section": "",
    "text": "GraphPad Prism 的风格"
  },
  {
    "objectID": "posts/ggprism/ggprism.html#先决条件",
    "href": "posts/ggprism/ggprism.html#先决条件",
    "title": "ggprism: GraphPad Prism 风格",
    "section": "先决条件",
    "text": "先决条件\n\nShow the code# install.packages(\"ggprism\")\nlibrary(ggprism)\nlibrary(patchwork)\nToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)\n\n\n\nShow the codenames(ggprism_data$themes)\n\n [1] \"autumn_leaves\"   \"beer_and_ales\"   \"black_and_white\" \"candy_bright\"   \n [5] \"candy_soft\"      \"colorblind_safe\" \"colors\"          \"diazo\"          \n [9] \"earth_tones\"     \"evergreen\"       \"greenwash\"       \"muted_rainbow\"  \n[13] \"office\"          \"purple_passion\"  \"shades_of_gray\"  \"summer\"         \n[17] \"the_blues\"       \"winter_soft\"     \"stained_glass\"   \"warm_pastels\"   \n[21] \"flames\"          \"floral\"          \"inferno\"         \"magma\"          \n[25] \"mustard_field\"   \"neon\"            \"pastels\"         \"pearl\"          \n[29] \"plasma\"          \"prism_dark\"      \"prism_light\"     \"quiet\"          \n[33] \"spring\"          \"starry\"          \"viridis\"         \"waves\"          \n[37] \"blueprint\"       \"fir\"             \"ocean\"           \"sunny_garden\"   \n[41] \"wool_muffler\"    \"warm_and_sunny\"  \"winter_bright\"   \"all_null\"       \n\nShow the codepreview_theme(\"colors\")\n\n\n\n\n\n\n\n\nShow the codelengths(ggprism_data$colour_palettes)\n\n  autumn_leaves   beer_and_ales black_and_white       blueprint      blueprint2 \n              9               9               9               9               9 \n     blueprint3    candy_bright      candy_soft colorblind_safe          colors \n              9               9               9               6              20 \n          diazo     earth_tones       evergreen             fir            fir2 \n              9              10               9               9               9 \n           fir3          flames         flames2          floral         floral2 \n              9               9               9              12              12 \n      greenwash         inferno           magma   mustard_field  mustard_field2 \n             10               6               6               9               9 \n  muted_rainbow            neon           ocean          ocean2          ocean3 \n             10               9               9               9               9 \n         office         pastels           pearl          pearl2          plasma \n              9               9               6               6               6 \n     prism_dark     prism_dark2     prism_light    prism_light2  purple_passion \n             10              10              10              10               9 \n          quiet          quiet2  shades_of_gray          spring         spring2 \n              9               9               9               9               9 \n  stained_glass  stained_glass2          starry         starry2          summer \n              9               9               5               5              10 \n   sunny_garden   sunny_garden2   sunny_garden3       the_blues         viridis \n              9               9               9               9               6 \n warm_and_sunny    warm_pastels   warm_pastels2           waves          waves2 \n              9               9               9               5               5 \n  winter_bright     winter_soft    wool_muffler   wool_muffler2   wool_muffler3 \n              9               9               9               9               9"
  },
  {
    "objectID": "posts/ggprism/ggprism.html#ggprism",
    "href": "posts/ggprism/ggprism.html#ggprism",
    "title": "ggprism: GraphPad Prism 风格",
    "section": "ggprism",
    "text": "ggprism\n散点图\n\nShow the codep1 &lt;- ggplot(msleep[complete.cases(msleep), ], \n             aes(x = sleep_rem, y = sleep_total)) + \n  geom_point(aes(shape = factor(vore)), size = 3) + \n  theme_prism() + \n  theme(axis.title.y = element_blank())\n\np2 &lt;- p1 + scale_shape_prism()\n\np1 + p2\n\n\n\n\n\n\n\n柱状图\n\nShow the codep1 &lt;- ggplot(ToothGrowth, aes(x = dose, y = len)) + \n  stat_summary(aes(fill = dose),\n               geom = \"col\", fun = mean, colour = \"black\", linewidth = 0.9) + \n  scale_y_continuous(limits = c(0, 30), expand = c(0, 0))\n\np2 &lt;- p1 + theme_prism(base_size = 14)\n\np1 + p2\n\n\n\n\n\n\n\n箱线图\n\nShow the codep &lt;- ggplot(ToothGrowth, aes(x = supp, y = len)) + \n  geom_boxplot(aes(colour = supp, fill = supp)) + \n  theme_prism(base_size = 12)\n\np1 &lt;- p + scale_colour_prism(palette = \"floral\") + \n  scale_fill_prism(palette = \"floral\")\n\np2 &lt;- p + scale_colour_prism(palette = \"flames\") + \n  scale_fill_prism(palette = \"flames\")\n\np1 + p2\n\n\n\n\n\n\n\n小提琴图\n\nShow the codep_vals &lt;- tibble::tribble(\n  ~group1, ~group2, ~p.adj,   ~y.position,\n  \"0.5\",   \"1\",     8.80e-14, 35,\n  \"0.5\",   \"2\",     1.27e-7,  39\n)\n\n\np1 &lt;- ggplot(ToothGrowth, aes(x = dose, y = len)) + \n  geom_violin(aes(colour = dose, fill = dose), trim = FALSE) + \n  geom_boxplot(aes(fill = dose), width = 0.2, colour = \"black\") + \n  scale_y_continuous(limits = c(-5, 40))+\n    add_pvalue(p_vals, label = \"p = {p.adj}\", tip.length = 0, label.size = 4)\n\n\np2 &lt;- p1 + \n  scale_color_prism(\"floral\") + \n  scale_fill_prism(\"floral\") + \n  theme_prism(base_size = 12) + \n  theme(legend.position = \"none\") + \n  add_pvalue(p_vals, label = \"p = {p.adj}\", tip.length = 0, label.size = 4)\n\n\np1+p2\n\n\n\n\n\n\n\n轴\n\nShow the codep &lt;- ggplot(ToothGrowth, aes(x = dose, y = len)) + \n  geom_jitter(aes(shape = dose), width = 0.2, size = 2) + \n  scale_shape_prism() + \n  theme_prism() + \n  theme(legend.position = \"none\")\n\np1 &lt;- p + scale_y_continuous(limits = c(0, 40), guide = \"prism_minor\")\n\np2 &lt;- p + scale_x_discrete(guide = \"prism_bracket\") + \n  scale_y_continuous(limits = c(0, 40))\n\np3 &lt;- p + scale_y_continuous(limits = c(0, 40), guide = \"prism_offset\")\n\np4 &lt;- p + scale_y_continuous(limits = c(0, 40), guide = \"prism_offset_minor\")\n\n(p1 + p2) / (p3 + p4)\n\n\n\n\n\n\n\n不连续轴\n\nShow the code# multiply one of the len values by 100\ntg &lt;- ToothGrowth\ntg[2, \"len\"] &lt;- tg[2, \"len\"] * 100\n\n\nggplot(tg, aes(x = dose, y = len)) + \n  geom_jitter(aes(shape = dose), width = 0.2, size = 2) + \n  scale_shape_prism() + \n  theme_prism() + \n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nShow the codep_bottom &lt;- ggplot(tg, aes(x = dose, y = len)) + \n  geom_jitter(aes(shape = dose), width = 0.2, size = 2) + \n  scale_shape_prism() + \n  coord_cartesian(ylim = c(0, 60)) + \n  guides(x = \"prism_bracket\", y = \"prism_offset_minor\") + \n  theme_prism() + \n  theme(legend.position = \"none\")\n\np_bottom\n\n\n\n\n\n\n\n\nShow the codep_top &lt;- ggplot(tg, aes(x = dose, y = len)) + \n  geom_jitter(aes(shape = dose), width = 0.2, size = 2) + \n  scale_shape_prism() + \n  coord_cartesian(ylim = c(1140, 1160)) +\n  scale_y_continuous(breaks = c(1140, 1160)) +\n  guides(y = \"prism_offset_minor\")\n\ntheme_outlier &lt;- function(palette = \"black_and_white\",\n                          base_size = 14,\n                          base_family = \"sans\",\n                          base_fontface = \"bold\",\n                          base_line_size = base_size/14,\n                          base_rect_size = base_size/14,\n                          axis_text_angle = 0,\n                          border = FALSE) {\n  theme_prism(palette = palette,\n              base_size = base_size,\n              base_family = base_family,\n              base_fontface = base_fontface,\n              base_line_size = base_line_size,\n              base_rect_size = base_rect_size,\n              axis_text_angle = axis_text_angle,\n              border = border) %+replace% \n    theme(axis.title = element_blank(),\n          axis.text.x = element_blank(),\n          axis.ticks.x = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\")\n}\n\np_top &lt;- p_top + theme_outlier()\np_top\n\n\n\n\n\n\nShow the codep_top / p_bottom + \n  plot_layout(heights = c(1, 4)) & \n  theme(axis.text.y = element_text(colour = \"red\"))\n\n\n\n\n\n\n\np值\n\nShow the code# create a jitter plot of the sleep data set\n# and indicate the means\np &lt;- ggplot(sleep, aes(x = group, y = extra)) +\n  geom_jitter(aes(shape = group), width = 0.1) + \n  stat_summary(geom = \"crossbar\", fun = mean, colour = \"red\", width = 0.2) + \n  theme_prism() + \n  theme(legend.position = \"none\")\np\n\n\n\n\n\n\n\n\nShow the coderesult &lt;- t.test(extra ~ group, data = sleep)$p.value\nresult &lt;- signif(result, digits = 3)\nresult\n\n[1] 0.0794\n\nShow the codedf_p_val &lt;- data.frame(\n  group1 = \"1\",\n  group2 = \"2\",\n  label = result,\n  y.position = 6\n)\n\n\n\nShow the codecolnames(df_p_val) &lt;- c(\"apple\", \"banana\", \"some_label\", \"some_y_position\")\n\n# add p-value brackets again\np + add_pvalue(df_p_val,\n                     xmin = \"apple\",\n                     xmax = \"banana\",\n                     label = \"some_label\",\n                     y.position = \"some_y_position\")\n\n\n\n\n\n\n\n\nShow the codecolnames(df_p_val) &lt;- c(\"group1\", \"group2\", \"label\", \"y.position\")\n# change bracket and label aesthetics\np1 &lt;- p + add_pvalue(df_p_val,\n                     colour = \"red\", # label\n                     label.size = 8, # label\n                     fontface = \"bold\", # label\n                     fontfamily = \"serif\", # label\n                     angle = 45, # label\n                     hjust = 1, # label\n                     vjust = 2, # label\n                     bracket.colour = \"blue\", # bracket\n                     bracket.size = 1, # bracket\n                     linetype = \"dashed\", # bracket\n                     lineend = \"round\") # bracket\n\n# use glue expression for label\np2 &lt;- p + add_pvalue(df_p_val, label = \"p = {label}\")\n\n# make bracket tips longer and use coord_flip\np3 &lt;- p + add_pvalue(df_p_val, tip.length = 0.15, coord.flip = TRUE) + \n  coord_flip()\n\n# change bracket tips independently\n# (make one side disappear and the other longer)\np4 &lt;- p + add_pvalue(df_p_val, tip.length = c(0.2, 0))\n\n(p1 + p2) / (p3 + p4)\n\n\n\n\n\n\n\n+ rstatix\n\n\nShow the codep &lt;- ggplot(ToothGrowth, aes(x = dose, y = len)) +\n  geom_boxplot(aes(fill = dose), colour = \"black\") + \n  theme_prism() + \n  theme(legend.position = \"none\")\n\ndf_p_val &lt;- rstatix::t_test(ToothGrowth, len ~ dose, ref.group = \"0.5\") %&gt;% \n  rstatix::add_xy_position()\n\np + add_pvalue(df_p_val, \n               label = \"p = {p.adj}\",\n               remove.bracket = TRUE)"
  },
  {
    "objectID": "posts/RT-qPCR/RT-qPCR.html",
    "href": "posts/RT-qPCR/RT-qPCR.html",
    "title": "RT-qPCR",
    "section": "",
    "text": "RT-qPCR\nhttps://bioconductor.org/packages/3.19/bioc/html/ReadqPCR.html"
  },
  {
    "objectID": "posts/UCSC/UCSC.html",
    "href": "posts/UCSC/UCSC.html",
    "title": "UCSC",
    "section": "",
    "text": "UCSC\nrtracklayer"
  },
  {
    "objectID": "posts/圆角柱状图/angle_rounded_barplot.html",
    "href": "posts/圆角柱状图/angle_rounded_barplot.html",
    "title": "ggforce: 圆角柱状图",
    "section": "",
    "text": "圆角的柱状图"
  },
  {
    "objectID": "posts/圆角柱状图/angle_rounded_barplot.html#先决条件",
    "href": "posts/圆角柱状图/angle_rounded_barplot.html#先决条件",
    "title": "ggforce: 圆角柱状图",
    "section": "先决条件",
    "text": "先决条件\n\nShow the codelibrary(ggforce)"
  },
  {
    "objectID": "posts/圆角柱状图/angle_rounded_barplot.html#geom_shape",
    "href": "posts/圆角柱状图/angle_rounded_barplot.html#geom_shape",
    "title": "ggforce: 圆角柱状图",
    "section": "geom_shape()",
    "text": "geom_shape()\n连续X\n\nShow the codeshape &lt;- data.frame(\n  x = c(0.25, 0.75,0.75,0.25),\n  y = c(0, 0,1,1)\n)\n\nggplot(shape, aes(x = x, y = y)) +\n  #geom_polygon(fill = 'red') +\n  geom_shape(radius = unit(0.5, 'cm'))+\n    scale_x_continuous(breaks = seq(0,2,1), limits = c(0,2))\n\n\n\n\n\n\n\n分类X\n\nShow the codedf &lt;- data.frame(trt = c(\"a\", \"b\", \"c\"), outcome = c(2.3, 1.9, 3.2))\n\nwidth &lt;- .9\n\ndf &lt;- df |&gt;\n    mutate(trt = factor(trt)) |&gt;\n    dplyr::reframe(\n        data.frame(\n            x = rep(as.numeric(trt) + width / 2 * c(-1, 1), each = 2), # 指定条形图四个角的坐标\n            outcome = c(c(0, outcome), rev(c(0, outcome)))\n        ),\n        .by = trt\n    )\ndf\n\n   trt    x outcome\n1    a 0.55     0.0\n2    a 0.55     2.3\n3    a 1.45     2.3\n4    a 1.45     0.0\n5    b 1.55     0.0\n6    b 1.55     1.9\n7    b 2.45     1.9\n8    b 2.45     0.0\n9    c 2.55     0.0\n10   c 2.55     3.2\n11   c 3.45     3.2\n12   c 3.45     0.0\n\nShow the codeggplot(df, aes(x, outcome, fill = trt)) +\n    geom_shape(radius = .05)+\n    scale_x_continuous(breaks = 1:3,labels = c(\"a\",\"b\",\"c\"))+\n    theme(\n        axis.title.x = element_blank()\n    )\n\n\n\n\n\n\n\n\nShow the codelibrary(ggforce)\nggplot(iris, aes(Petal.Length, Petal.Width, colour = Species)) +\n  geom_point() +\n  facet_zoom(x = Species == \"versicolor\")"
  }
]