{
  "hash": "612dbea88000aa50e65d7d8e8383feb2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"ggpattern: ggplot2 with geometric texture amd images\"\ndate: \"2024-09-24\"\ndate-modified: today\ncategories: [graphics, ggplot2 extension]\nimage: \"example.svg\"\n---\n\n\nggpattern 填充几何纹理或图像\n\n## 先决条件\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(ggpattern)\nlibrary(gridpattern)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\ndf <- tibble(\n    group = letters[1:5],\n    value = round(runif(5,min = 10,max = 100),digits = 0)\n)\n\ndf %>% \n    ggplot(mapping = aes(x = group, y = value, fill = group)) +\n    geom_col()\n```\n\n::: {.cell-output-display}\n![](ggpattern_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## [ggpattern](https://trevorldavis.com/R/ggpattern/dev/)\n\n### 几何纹理\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames_magick_stripe\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"crosshatch\"    \"crosshatch30\"  \"crosshatch45\"  \"horizontal\"   \n [5] \"horizontal2\"   \"horizontal3\"   \"hs_bdiagonal\"  \"hs_cross\"     \n [9] \"hs_diagcross\"  \"hs_fdiagonal\"  \"hs_horizontal\" \"hs_vertical\"  \n[13] \"left30\"        \"left45\"        \"right30\"       \"right45\"      \n[17] \"vertical\"      \"vertical2\"     \"vertical3\"    \n```\n\n\n:::\n\n```{.r .cell-code}\nnames_hex\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"hex\"      \"hex1\"     \"hex2\"     \"hex3\"     \"hex_skew\"\n```\n\n\n:::\n\n```{.r .cell-code}\nnames_pattern\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"ambient\"         \"circle\"          \"crosshatch\"      \"fill\"           \n [5] \"gradient\"        \"image\"           \"magick\"          \"none\"           \n [9] \"pch\"             \"placeholder\"     \"plasma\"          \"polygon_tiling\" \n[13] \"regular_polygon\" \"rose\"            \"stripe\"          \"text\"           \n[17] \"wave\"            \"weave\"          \n```\n\n\n:::\n:::\n\n\n `'stripe' (default), 'crosshatch', 'pch', 'circle', 'none'`\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(df, aes(group, value )) +\n  geom_col_pattern(pattern = \"stripe\", \n                   fill= \"white\",  # 条形背景色 \n                   color=\"red\",    # 条形边框色\n                   pattern_fill = \"skyblue\", # 几何纹理填充色\n                   pattern_colour=\"darkgreen\",\n                   pattern_angle =30,    # 旋转角度\n                   pattern_linetype= 3 ,# 笔划stroke 线型\n                   pattern_size= 1.2,\t#笔画线宽\n                   ) +\n    ggtitle(\"线条：stripe\")\n\np2 <- ggplot(df, aes(group, value )) +\n  geom_col_pattern(pattern = \"crosshatch\", \n                   fill= \"white\",  # 条形背景色 \n                   color=\"red\",    # 条形边框色\n                   pattern_fill = \"red\", # 几何纹理填充色\n                   pattern_colour=\"green\",\n                   pattern_angle =30 ,  # 角度\n                   pattern_spacing= 0.2\n                   ) +\n    ggtitle(\"交叉平行线：crosshatch\")\n\n\np3 <- ggplot(df, aes(group, value )) +\n  geom_col_pattern(pattern = \"pch\",\n                   fill= \"white\",  # 条形背景色 \n                   color=\"red\",    # 条形边框色\n                   pattern_colour=\"green\",\n                   pattern_angle =30,  \n                   pattern_density = 1,\n                   ) +\n    ggtitle(\"点：pch\")\n\np4 <- ggplot(df, aes(group, value )) +\n  geom_col_pattern(pattern = \"circle\",\n                   fill= \"white\",  # 条形背景色 \n                   color=\"red\",    # 条形边框色\n                   pattern_colour=\"darkgreen\",\n                   pattern_fill = \"skyblue\",\n                   pattern_angle =30,   # 角度\n                   pattern_density = 1,\n                   pattern_spacing= 0.2, # 间距\n                   ) +\n    ggtitle(\"圈：circle\")\n\n(p1+p2)/(p3+p4)\n```\n\n::: {.cell-output-display}\n![](ggpattern_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### 波浪图案\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_hex <- 0.5 + 0.5 * cos(seq(2 * pi / 4, by = 2 * pi / 6, length.out = 6))\ny_hex <- 0.5 + 0.5 * sin(seq(2 * pi / 4, by = 2 * pi / 6, length.out = 6))\ngrid::grid.newpage()\nwave_sine <- grid.pattern_wave(x_hex, y_hex, colour = \"black\", type = \"sine\",\n                  fill = c(\"red\", \"blue\"), density = 0.4,\n                  spacing = 0.15, angle = 0,\n                  amplitude = 0.05, frequency = 1 / 0.20)\n```\n\n::: {.cell-output-display}\n![](ggpattern_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# zig-zag pattern is a wave of \"type = triangle\"\ngrid::grid.newpage()\nwave_triangle <- grid.pattern_wave(x_hex, y_hex, colour = \"black\", \n                                   type = \"triangle\",\n                    fill = c(\"red\", \"blue\"), density = 0.4,\n                    spacing = 0.15, angle = 0, amplitude = 0.075)\n```\n\n::: {.cell-output-display}\n![](ggpattern_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n### 编织类型\n\n`pattern_type=` ,\n\n`pattern_subtype=`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames_weave\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"basket\"            \"matt\"              \"matt_irregular\"   \n [4] \"plain\"             \"rib_warp\"          \"satin\"            \n [7] \"twill\"             \"twill_elongated\"   \"twill_herringbone\"\n[10] \"twill_zigzag\"     \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(group, value)) +\n  geom_col_pattern(\n    aes(pattern_fill2=group, pattern_type=group),\n    pattern = 'weave',\n    colour = 'black', \n    pattern_density = 1.0,\n    pattern_fill = 'grey',\n    pattern_key_scale_factor = 0.5,\n  ) +\n  theme_bw() +\n  labs(title = \"Some 'weave' types\") + \n  scale_pattern_type_manual(values=c('plain','matt', 'twill_herringbone',\n                                     \"twill_zigzag\",'satin')) +\n  theme(legend.key.size = unit(1.5, 'cm'))\n```\n\n::: {.cell-output-display}\n![](ggpattern_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n### 混合模式\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(group, value)) +\n  geom_col_pattern(aes(fill=group, pattern=group, pattern_type=group),colour='black') + \n  theme_bw() +\n  labs(title = \"Use 'stripe' and 'weave' patterns\") + \n  theme(legend.key.size = unit(1.5, 'cm')) +\n  scale_pattern_manual(values=c('stripe', 'weave', 'weave','stripe', 'weave')) +\n  scale_pattern_type_manual(values=c(NA, 'basket', 'matt', NA, 'twill_elongated'))\n```\n\n::: {.cell-output-display}\n![](ggpattern_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggpattern)\nToothGrowth$dose <- factor(ToothGrowth$dose)\nggplot(ToothGrowth, aes(dose)) +\n  geom_bar_pattern(aes(fill=dose, pattern=dose, pattern_type=dose),colour='black') + \n  theme_bw() +\n  labs(title = \"Use 'stripe' and 'wave' patterns\") + \n  theme(legend.key.size = unit(1.5, 'cm')) +\n  scale_pattern_manual(values=c('stripe', 'wave', 'wave')) +\n  scale_pattern_type_manual(values=c(NA, 'triangle', 'sine'))\n```\n\n::: {.cell-output-display}\n![](ggpattern_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## ggpattern + ggh4x\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggh4x)\nlibrary(ggpattern)\n\nset.seed(233)\ntable1 <- tibble(\n  x=letters[1:4] %>% rep(each=16,length.out=192),\n  y=abs(rnorm(192,50,10)),\n  f=LETTERS[1:4] %>% rep(each=4,length.out=192),\n  g=\"g1\"\n)\ntable2 <- tibble(\n  x=letters[1:4] %>% rep(each=16,length.out=192),\n  y=abs(rnorm(192,50,10)) %>% sort(),\n  f=LETTERS[1:4] %>% rep(each=4,length.out=192),\n  g=\"g2\"\n)\ntable3 <- tibble(\n  x=letters[1:4] %>% rep(each=16,length.out=192),\n  y=abs(rnorm(192,50,10)),\n  f=LETTERS[1:4] %>% rep(each=4,length.out=192),\n  g=\"g3\"\n)\n\ntableAll <- bind_rows(table1,table2,table3)\n\np1 <- tableAll %>% ggplot(aes(interaction(x, g),y,pattern=f)) +\n  stat_summary(geom=GeomColPattern,\n               fun = mean,\n               position = position_dodge(width = 1.2),\n               pattern_spacing = 0.025,\n               fill = 'white', \n               colour = 'black',) + \n  stat_summary(geom=\"errorbar\",\n               fun.data = mean_se,\n               position = position_dodge(width = 1.2)) + \n  scale_x_manual(values = c(1:4+seq(0,1,length.out=4),6:9+1+seq(0,1,length.out=4),11:14+2+seq(0,1,length.out=4)),guide = guide_axis_nested()) +\n  scale_y_continuous(expand = expansion(mult = c(0,0)),\n                     breaks = seq(0,80,by=10),) +\n  labs(x=NULL,y=NULL,pattern=NULL) +\n  guides(pattern=guide_legend(nrow = 1)) +\n  coord_cartesian(ylim = c(0,70)) +\n  theme_classic() + \n  theme(legend.position = \"inside\",\n        legend.position.inside = c(.83,.95),\n        axis.ticks.length.x = unit(0,\"mm\"),\n        axis.ticks.length.y = unit(-1,\"mm\"),\n        ggh4x.axis.nestline = element_line(color=NA))\np1\n```\n\n::: {.cell-output-display}\n![](ggpattern_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}