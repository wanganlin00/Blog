"0","fern_transform <- function(coord, ind) {"
"0","  "
"0","  # coefficients for the stem function f_1"
"0","  if(ind == 1) {"
"0","    mat <- matrix(c(0, 0, 0, .16), 2, 2) # matrix to multiply"
"0","    off <- c(0, 0)                       # offset vector to add"
"0","  }"
"0","  "
"0","  # coefficients for the small leaflet function f_2"
"0","  if(ind == 2) {"
"0","    mat <- matrix(c(.85, -.04, .04, .85), 2, 2)"
"0","    off <- c(0, 1.6)                      "
"0","  }"
"0","  # coefficients for the right-side function f_3"
"0","  if(ind == 3) {"
"0","    mat <- matrix(c(.2, .23, -.26, .22), 2, 2)"
"0","    off <- c(0, 1.6)                      "
"0","  }"
"0","  "
"0","  # coefficients for the left-side function f_4"
"0","  if(ind == 4) {"
"0","    mat <- matrix(c(-.15, .26, .28, .24), 2, 2)"
"0","    off <- c(0, .44)                     "
"0","  }"
"0","  "
"0","  # return the affine transformed coords"
"0","  coord <- mat %*% coord + off"
"0","  return(coord)"
"0","}"
